FROM otel/opentelemetry-collector:0.49.0

ARG NEW_RELIC_API_KEY
ARG OTEL_EXPORTER_OTLP_ENDPOINT
ARG OTEL_EXPORTER_OTLP_ENDPOINT_INFINITE_TRACING

ENV NEW_RELIC_API_KEY=${NEW_RELIC_API_KEY}
ENV OTEL_EXPORTER_OTLP_ENDPOINT=${OTEL_EXPORTER_OTLP_ENDPOINT}
ENV OTEL_EXPORTER_OTLP_ENDPOINT_INFINITE_TRACING=${OTEL_EXPORTER_OTLP_ENDPOINT_INFINITE_TRACING}

COPY ./collector.yaml /etc/otel/config.yaml

ENTRYPOINT ["/otelcorecol"]
CMD ["--config", "/etc/otel/config.yaml"]
EXPOSE 55680 55679 9411 14250 14268 13133 4317 4318
